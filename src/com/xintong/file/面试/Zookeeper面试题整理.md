# Zookeeper面试题

##### 1 说说你对zookeeper的理解?

官网对zookeeper的描述是一个分布式协调服务，其实翻译过来就是说可以用它来维护多个系统之间的状态，以及一些数据的一致性。基于zk的核心：***文件系统***、***通知机制***，我们可以去实现注册中心、配置中心、分布式锁、分布式事务====功能

##### 2 为什么zookeeper能作为注册中心

简单的注册中心的本质就是去维护服务的提供者消费者对应的关系，而zk的这种文件系统又特别适合

我之前项目有用到zk给dubbo做注册中心，那我就说说zk作为dubbo注册中心的原理

首先我得说一下，用zk给dubbo做注册中心时，zk内部node节点的父子层级关系，

![image-20200418141633802](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200418141633802.png)

会在根目录下创建dubbo节点，这个dubbo节点节点下又有好多节点，其中有一个metadata节点这个我们不关心，其余的都是类名节点，这个类名节点下又有4个节点，其中两个一个是consumers另一个是providers，也就是提供者和消费者，剩下的两个节点我们先不去关心，consumers里面的每个节点都代表这个服务的每个消费者信息，providers里面的每个节点都代表着每个消费者信息。

当提供者启动的时候，他会在zk中创建/dubbo/类名/providers/提供者信息 这样的一个节点

当消费者启动的时候，他会在zk中创建/dubbo/类名/consumers/消费者信息 这样的一个节点

当消费者首次调用的时候，他回去注册中心拿到对应的所有提供者列表并本地缓存，后续调用便不再请求注册中心

当提供者断开或者新增的时候，基于zk的Watcher机制。会去通知对应的消费者重新去缓存提供者的信息

##### 3 zookeeper节点类型

1. 临时有序
2. 临时无序
3. 持久有序
4. 持久无序

##### 4 zookeeper临时节点实现原理

##### 5 zookeeper角色

1. ***Leader***：zk集群中的主节点，主要负责的是事务操作，换句话说就是主要负责写操作（增删改）
2. ***Follower***：主要负责非事务操作（读操作），另外还会参加选举以及相应提议
3. ***Observer***：一般来说这个角色不必存在，只有在读请求负载特别高的时候去配置Observer，但是这个Observer不选举也不提议，只负责读操作

##### 6 CAP理论

##### 7

##### 8

##### 9

##### 10